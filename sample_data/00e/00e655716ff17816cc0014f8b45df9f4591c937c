                var enc = new System.Text.UTF8Encoding();
                var keyGen = new Rfc2898DeriveBytes(credentials.Password, enc.GetBytes(MvcApplication.Salt));
                var key = keyGen.GetBytes(32);
                var iv = keyGen.GetBytes(16);

                var cipher = new RijndaelManaged
                             {
                                 Key = key,
                                 IV = iv
                             };

                var plainText = enc.GetBytes(credentials.Password);
                using (var encryptor = cipher.CreateEncryptor())
                {
                    using (var ms = new MemoryStream())
                    {
                        using (var cs = new CryptoStream(ms, encryptor, CryptoStreamMode.Write))
                        {
                            cs.Write(plainText, 0, plainText.Length);
                            cs.FlushFinalBlock();

                            allowLogin = password == enc.GetString(ms.ToArray());
                        }
                    }
                }