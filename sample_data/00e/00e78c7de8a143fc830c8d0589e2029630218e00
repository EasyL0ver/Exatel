#include <iostream>
#include <cstdio>
#include <vector>
#define MAXN 112345
#define F first
#define S second
#include <cstdlib>
#include <ctime>
using namespace std;
typedef long long int ll;
int pai[MAXN];
ll cost[MAXN];
int findS(int i) {
    if (i == pai[i]) return i;
    int p = findS(pai[i]);
    cost[i] += cost[pai[i]];
    return pai[i] = p;
}

void join(int a, int b, ll w) {
    int pa = findS(a);
    int pb = findS(b);
    if (pa == pb) return;
    w += cost[b] - cost[a];
    if(rand()&1) {
        pa^= pb, pb^=pa, pa^=pb;
        w = -w;
    }
    pai[pa] = pb;
    cost[pa] = w;
}

int main() {
    int n, m, a,b,w;
    char x;
    srand(time(NULL));
    while (scanf("%d %d", &n, &m) && n) {
        for (int i = 1; i<=n; ++i) {
            pai[i] = i;
            cost[i] = 0;
        }

        while (m--) {
           scanf(" %c", &x);
           if (x == '!') {
                scanf("%d %d %d", &a, &b, &w);
                join(a,b,(ll)w);
           } else {
                scanf("%d %d", &a, &b);
                if (findS(a) == findS(b)) {
                    printf("%lld\n", cost[a]-cost[b]);
                } else {
                    puts("UNKNOWN");
                }
           }
        }
    }

}