package me.thefruitey.muxcraft;

import org.bukkit.Bukkit;
import org.bukkit.Material;
import org.bukkit.entity.Entity;
import org.bukkit.entity.Player;
import org.bukkit.event.EventHandler;
import org.bukkit.event.Listener;
import org.bukkit.event.inventory.InventoryClickEvent;
import org.bukkit.event.player.PlayerInteractEntityEvent;
import org.bukkit.inventory.Inventory;

import java.util.Arrays;

public class Handle implements Listener {

    private final Main instance;
    private Inventory inventory;
    private String title;

    public Handle(Main instance) {
        this.instance = instance;
        this.instance.getServer().getPluginManager().registerEvents(this, instance);
        this.inventory = getInventory();
        this.title = getTitle();
    }

    public void setTitle(String title) {
        this.title = title;
    }

    public String getTitle() {
        return title;
    }

    public Inventory getInventory() {
        return inventory;
    }

    @EventHandler
    public void onPlayerInteractEntity(PlayerInteractEntityEvent ev) {
        Player player = ev.getPlayer();
        Entity target = ev.getRightClicked();
        if (target instanceof Player) {
            setTitle("§0§lMuxPlayers §0| " + target.getName());
            inventory = Bukkit.createInventory(null, 27, getTitle());
            getInventory().setItem(10, new Item(Material.GOLD_HELMET, 1).setDisplayName("§b§lHandeln").setLore(Arrays.asList("§7Handle mit " + target.getName() + ".")).build());
            getInventory().setItem(12, new Item(Material.CHAINMAIL_HELMET, 1).setDisplayName("§b§lClans").setLore(Arrays.asList("§7Claneinladung an " + target.getName() + " verschicken.")).build());
            getInventory().setItem(14, new Item(Material.IRON_HELMET, 1).setDisplayName("§b§lFreunde").setLore(Arrays.asList("§7Freundschaftsangebot an " + target.getName() + " verschicken.")).build());
            getInventory().setItem(16, new Item(Material.DIAMOND_HELMET, 1).setDisplayName("§b§lStats").setLore(Arrays.asList("§7Statistiken von " + target.getName() + " angezeigen lassen.")).build());
            player.openInventory(getInventory());
        }
    }

    @EventHandler
    public void onInventoryClick(InventoryClickEvent ev) {
        if (ev.getInventory().getTitle().contains("MuxPlayers")) {
            ev.setCancelled(true);
        }
    }

}