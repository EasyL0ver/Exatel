private void RData(object sender, SerialDataReceivedEventArgs e)
        {
            if (InvokeRequired)
            {
                Invoke(new MethodInvoker(RData2));
            }
        }

private void RData2()
        {
            listBox1.Items.Add(serialPort1.ReadExisting());
        }

private void SendCMDs_Click(object sender, EventArgs e)
        {
            serialPort1.DataReceived += new SerialDataReceivedEventHandler(RData);

            serialPort1.PortName = comboBox1.SelectedItem.ToString();
            serialPort1.BaudRate = 9600;
            serialPort1.Parity = Parity.None;
            serialPort1.StopBits = StopBits.One;
            serialPort1.DataBits = 8;
            serialPort1.Handshake = Handshake.None;
            serialPort1.Encoding = Encoding.Default;

            try
            {
                serialPort1.Open();
                serialPort1.Write("en\r\n");
                serialPort1.Write(txtEn.Text + "\r\n");
                serialPort1.Write("show run\r\n");
            }
            catch (Exception io)
            {
                MessageBox.Show("Port already open or errors have occured");
                MessageBox.Show(io.Message);
            }
            serialPort1.Close();
        }