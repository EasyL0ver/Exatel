	function incloudturb()
		if XPLMFindDataRef("xjpc/XPNoaaWeather/config/override_turbulence") ~= nil then
			ictmultiplier = 0.2
			if (PLANE_ICAO == "A320) then ictmultiplier = 0.5 end
			icttolbas = 0
			icttoltop = 2000
			

			ictcb0=get("sim/weather/cloud_base_msl_m[0]")
			ictcb1=get("sim/weather/cloud_base_msl_m[1]")
			ictcb2=get("sim/weather/cloud_base_msl_m[2]")

			ictct0=get("sim/weather/cloud_tops_msl_m[0]")
			ictct1=get("sim/weather/cloud_tops_msl_m[1]")
			ictct2=get("sim/weather/cloud_tops_msl_m[2]")

			ictcc0=get("sim/weather/cloud_coverage[0]")
			ictcc1=get("sim/weather/cloud_coverage[1]")
			ictcc2=get("sim/weather/cloud_coverage[2]")

			ictalt=get("sim/flightmodel/position/elevation")	
			
			local ictinclouds = false
			local icttype = 0
			
			if (ictalt >= ictcb0-icttolbas) and (ictalt <= ictct0+icttoltop) and (ictcc0 > 0) then
				ictinclouds = true
				icttype = ictcc0
			elseif (ictalt >= ictcb1-icttolbas) and (ictalt <= ictct1+icttoltop) and (ictcc1 > 0) then
				ictinclouds = true
				icttype = ictcc1
			elseif (ictalt >= ictcb2-icttolbas) and (ictalt <= ictct2+icttoltop) and (ictcc2 > 0) then
				ictinclouds = true
				icttype = ictcc2
			else
				ictinclouds = false
			end	
			

			
			if ictinclouds == true then
				local ictstrength = 5
				if icttype <= 4 then ictstrength = 3*ictmultiplier end
				if icttype <= 3 then ictstrength = 2*ictmultiplier end
				if icttype <= 2 then ictstrength = 1*ictmultiplier end
				
				set("xjpc/XPNoaaWeather/config/override_turbulence", 1)
				set("sim/weather/turbulence[0]", ictstrength)
				set("sim/weather/turbulence[1]", ictstrength)
				set("sim/weather/turbulence[2]", ictstrength)
				set("sim/weather/wind_turbulence_percent", 1)
			else
				set("xjpc/XPNoaaWeather/config/override_turbulence", 0)
				set("sim/weather/wind_turbulence_percent", 0)
			end
		end
	end
	do_often("incloudturb()")