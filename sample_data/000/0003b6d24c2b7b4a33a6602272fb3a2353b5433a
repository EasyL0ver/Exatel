package org.deob;

import java.util.ArrayList;

import org.deob.idents.Identification;
import org.deob.idents.impl.Client;
import org.deob.trans.Transformer;
import org.deob.trans.impl.IPChanger;
import org.deob.util.JARSigner;
import org.objectweb.asm.tree.ClassNode;

/**
 * @author `Discardedx2<discardedx2@rune-server.org>
 * @project RS Deobfuscator
 * @file org.deob.impl.Deobfuscator.java
 * @date May 24, 2010 <summary></summary>
 */

public class Deobfuscator {
	public ArrayList<Transformer> trans = new ArrayList<Transformer>();
	public ArrayList<Identification> idents = new ArrayList<Identification>();

	public Deobfuscator() {
		{// load transformers
			trans.add(new IPChanger());
		}
		{// load identifiers
			idents.add(new Client());
		}
		for (final ClassNode c : JARSigner.clazzes) {
			for (final Identification i : idents) {
				if (i.foundClass(c)) {
					System.out.println("> The " + i.getIdentName()
							+ " class has been identified as " + c.name);
				}
			}
			for (Transformer transformers : trans) {
				transformers.execute(c);
			}
		}
	}
}