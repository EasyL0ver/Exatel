if ( ! $user || is_wp_error( $user ) ) {
        setcookie( $rp_cookie, ' ', time() - YEAR_IN_SECONDS, $rp_path, COOKIE_DOMAIN, is_ssl(), true );
        if ( $user && $user->get_error_code() === 'expired_key' )
            wp_redirect( site_url( 'wp-login.php?action=lostpassword&error=expiredkey' ) );
        else
            wp_redirect( site_url( 'wp-login.php?action=lostpassword&error=invalidkey' ) );
        exit;
    }