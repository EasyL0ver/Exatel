#include <Servo.h>
#include <SoftwareSerial.h>
#include <LiquidCrystal.h>

// Setting LCD RS E D4 D5 D6 D7
LiquidCrystal lcd(2, 3, 4, 5, 6, 7);
const int trigPin = 12;
const int echoPin = 11;

long durasi;
int jarak ;
int i;
int LEDbiru = 9;//lampu led merah
int LEDmerah = 8;//lampu led kuning

Servo myservo;
void setup() {
  myservo.attach(13);
  myservo.write(0);
  delay(100);
  pinMode(trigPin, OUTPUT);
  pinMode(echoPin, INPUT);
  pinMode(LEDbiru, OUTPUT);
  pinMode(LEDmerah, OUTPUT);
  pinMode(LEDbiru, OUTPUT);
  Serial.begin(9600);

   lcd.begin(16,2);
   lcd.print("Tinggi Air:");
}

void loop() { 
  digitalWrite(trigPin, LOW);
  delayMicroseconds(2);
  digitalWrite(trigPin, HIGH);
  delayMicroseconds(10);
  digitalWrite(trigPin, LOW);

  durasi = pulseIn(echoPin, HIGH);
  jarak = durasi*0.034/2;

  lcd.setCursor(14, 0);
  lcd.print(" M");
  lcd.setCursor(13, 0);
  lcd.print(18-jarak); 

  lcd.setCursor(2, 1);
  lcd.print("SIPIO-TIF '16");

  if(jarak <= 10){ //buka pintu 
          digitalWrite(LEDbiru, LOW);           
          myservo.write(180);
              for(i=1;i<=2;i++){
                digitalWrite(LEDmerah, HIGH); 
                delay(250);
                digitalWrite(LEDmerah, LOW);
                delay(250); 
                }                    
    }
    else if(jarak >= 12 ){//tutup pintu
      digitalWrite(LEDmerah, LOW); 
      digitalWrite(LEDbiru, HIGH);       
      myservo.write(0);           
     }
    
}