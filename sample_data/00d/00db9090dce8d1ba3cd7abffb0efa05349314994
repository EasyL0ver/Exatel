Index: lucene/codecs/src/java/org/apache/lucene/codecs/appending/AppendingTermsWriter.java
===================================================================
--- lucene/codecs/src/java/org/apache/lucene/codecs/appending/AppendingTermsWriter.java	(revision 1387561)
+++ lucene/codecs/src/java/org/apache/lucene/codecs/appending/AppendingTermsWriter.java	(working copy)
@@ -30,13 +30,13 @@
  * @lucene.experimental
  */
 public class AppendingTermsWriter extends BlockTreeTermsWriter {
-  final static String TERMS_CODEC_NAME = "APPENDING_TERMS_DICT";
-  final static int TERMS_VERSION_START = 0;
-  final static int TERMS_VERSION_CURRENT = TERMS_VERSION_START;
+  final static String APPENDING_TERMS_CODEC_NAME = "APPENDING_TERMS_DICT";
+  final static int APPENDING_TERMS_VERSION_START = 0;
+  final static int APPENDING_TERMS_VERSION_CURRENT = TERMS_VERSION_START;
   
-  final static String TERMS_INDEX_CODEC_NAME = "APPENDING_TERMS_INDEX";
-  final static int TERMS_INDEX_VERSION_START = 0;
-  final static int TERMS_INDEX_VERSION_CURRENT = TERMS_INDEX_VERSION_START;
+  final static String APPENDING_TERMS_INDEX_CODEC_NAME = "APPENDING_TERMS_INDEX";
+  final static int APPENDING_TERMS_INDEX_VERSION_START = 0;
+  final static int APPENDING_TERMS_INDEX_VERSION_CURRENT = TERMS_INDEX_VERSION_START;
   
   public AppendingTermsWriter(SegmentWriteState state, PostingsWriterBase postingsWriter, int minItemsInBlock, int maxItemsInBlock) throws IOException {
     super(state, postingsWriter, minItemsInBlock, maxItemsInBlock);
@@ -44,11 +44,13 @@
 
   @Override
   protected void writeHeader(IndexOutput out) throws IOException {
+    CodecUtil.writeHeader(out, APPENDING_TERMS_CODEC_NAME, APPENDING_TERMS_VERSION_CURRENT);
     CodecUtil.writeHeader(out, TERMS_CODEC_NAME, TERMS_VERSION_CURRENT);
   }
 
   @Override
   protected void writeIndexHeader(IndexOutput out) throws IOException {
+    CodecUtil.writeHeader(out, APPENDING_TERMS_INDEX_CODEC_NAME, APPENDING_TERMS_INDEX_VERSION_CURRENT);
     CodecUtil.writeHeader(out, TERMS_INDEX_CODEC_NAME, TERMS_INDEX_VERSION_CURRENT);
   }
 
Index: lucene/codecs/src/java/org/apache/lucene/codecs/appending/AppendingTermsReader.java
===================================================================
--- lucene/codecs/src/java/org/apache/lucene/codecs/appending/AppendingTermsReader.java	(revision 1387561)
+++ lucene/codecs/src/java/org/apache/lucene/codecs/appending/AppendingTermsReader.java	(working copy)
@@ -20,6 +20,7 @@
 import java.io.IOException;
 
 import org.apache.lucene.codecs.BlockTreeTermsReader;
+import org.apache.lucene.codecs.BlockTreeTermsWriter;
 import org.apache.lucene.codecs.CodecUtil;
 import org.apache.lucene.codecs.PostingsReaderBase;
 import org.apache.lucene.index.FieldInfos;
@@ -41,16 +42,22 @@
 
   @Override
   protected void readHeader(IndexInput input) throws IOException {
-    CodecUtil.checkHeader(input, AppendingTermsWriter.TERMS_CODEC_NAME,
-        AppendingTermsWriter.TERMS_VERSION_START,
-        AppendingTermsWriter.TERMS_VERSION_CURRENT);  
+    CodecUtil.checkHeader(input, AppendingTermsWriter.APPENDING_TERMS_CODEC_NAME,
+        AppendingTermsWriter.APPENDING_TERMS_VERSION_START,
+        AppendingTermsWriter.APPENDING_TERMS_VERSION_CURRENT);  
+    CodecUtil.checkHeader(input, BlockTreeTermsWriter.TERMS_CODEC_NAME,
+        BlockTreeTermsWriter.TERMS_VERSION_START,
+        BlockTreeTermsWriter.TERMS_VERSION_CURRENT); 
   }
 
   @Override
   protected void readIndexHeader(IndexInput input) throws IOException {
-    CodecUtil.checkHeader(input, AppendingTermsWriter.TERMS_INDEX_CODEC_NAME,
-        AppendingTermsWriter.TERMS_INDEX_VERSION_START,
-        AppendingTermsWriter.TERMS_INDEX_VERSION_CURRENT);
+    CodecUtil.checkHeader(input, AppendingTermsWriter.APPENDING_TERMS_INDEX_CODEC_NAME,
+        AppendingTermsWriter.APPENDING_TERMS_INDEX_VERSION_START,
+        AppendingTermsWriter.APPENDING_TERMS_INDEX_VERSION_CURRENT);
+    CodecUtil.checkHeader(input, BlockTreeTermsWriter.TERMS_INDEX_CODEC_NAME,
+        BlockTreeTermsWriter.TERMS_INDEX_VERSION_START,
+        BlockTreeTermsWriter.TERMS_INDEX_VERSION_CURRENT);
   }
   
   @Override
Index: lucene/core/src/java/org/apache/lucene/codecs/BlockTreeTermsWriter.java
===================================================================
--- lucene/core/src/java/org/apache/lucene/codecs/BlockTreeTermsWriter.java	(revision 1387561)
+++ lucene/core/src/java/org/apache/lucene/codecs/BlockTreeTermsWriter.java	(working copy)
@@ -96,14 +96,14 @@
 
   /** Extension of terms file */
   static final String TERMS_EXTENSION = "tim";
-  final static String TERMS_CODEC_NAME = "BLOCK_TREE_TERMS_DICT";
+  public static final String TERMS_CODEC_NAME = "BLOCK_TREE_TERMS_DICT";
   // Initial format
   public static final int TERMS_VERSION_START = 0;
   public static final int TERMS_VERSION_CURRENT = TERMS_VERSION_START;
 
   /** Extension of terms index file */
   static final String TERMS_INDEX_EXTENSION = "tip";
-  final static String TERMS_INDEX_CODEC_NAME = "BLOCK_TREE_TERMS_INDEX";
+  public static final String TERMS_INDEX_CODEC_NAME = "BLOCK_TREE_TERMS_INDEX";
   // Initial format
   public static final int TERMS_INDEX_VERSION_START = 0;
   public static final int TERMS_INDEX_VERSION_CURRENT = TERMS_INDEX_VERSION_START;