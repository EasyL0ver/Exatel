import tweepy, time
from twitterKeys import *
auth = tweepy.OAuthHandler(consumer_key, consumer_secret)
auth.set_access_token(access_token, access_token_secret)
api = tweepy.API(auth)
minRatio = 30
maxRatio = 99
minFollowers = 100
maxFollowers = 100000000
badwords = ['sex','fuck','nude','naked','slut','18+','whore','cam','porn','tit','blowjob','cock','dick','pussy','boob','gay']
who = input("Who's contact would you like to grab? ")
what = input("What to grab? 1=Friends, 2=Followers: ")
followed = 0

def checkSwear(words):
    for swear in badwords:
        if swear.lower() in words.lower():
            return False
            break    
    return True

def checkUser(userName):
    global followed
    user = api.get_user(userName)
    #print(json.dumps(user, indent=2, sort_keys=True))
    followers = user.followers_count
    friends = user.friends_count
    ratio = int((followers / (friends + followers))*100)
    print (user.screen_name, " - Followers: ", followers, " Friends: ", friends, " Ratio: ", ratio,"%")
    badCheck = user.screen_name+' '+user.description+' '+user.name
    if ratio > minRatio and ratio < maxRatio and followers > minFollowers and followers < maxFollowers:
        if user.following:
           print("\n--------------- Already Following ",user.screen_name,"---------------------\n") 
        elif checkSwear(badCheck):
            followed += 1
            print("\n--------------- FOLLOWING ",user.screen_name,"(",followed,")---------------------")
            print ("----- Followers: ", followers, " Friends: ", friends, " Ratio: ", ratio,"% -----")
            return True

if what == '2':
    people = sorted(api.followers_ids(who), reverse=False)
    print('FOLLOWERS: ',len(people))
else:
    people = sorted(api.friends_ids(who), reverse=False)
    print('FRIENDS: ',len(people))

for person in people:
    time.sleep(1)
    try:
        if checkUser(person):
            api.get_user(person).follow()
            time.sleep(3)
    except BaseException as e:
        errorMSG = str(e)
        print(errorMSG)
        if 'Rate limit exceeded' in errorMSG:
            print("Sleeping for 10 minutes...")
            time.sleep(600)
            continue
        elif 'You are unable to follow more' in errorMSG:
            break
        else:
            continue
    except:
        break