#include <stdio.h>
#define ulli unsigned long long int

ulli numSubMat(ulli r, ulli c, ulli m)
{
	ulli result=1;

	if (r%2==0)
	{
		result=(result*((r/2)%m))%m;
		result=(result*((r+1)%m))%m;
	}

	else
	{
		result=(result*(r%m))%m;
		result=(result*(((r+1)/2)%m))%m;
	}

	if (c%2==0)
	{
		result=(result*((c/2)%m))%m;
		result=(result*((c+1)%m))%m;
	}

	else
	{
		result=(result*(c%m))%m;
		result=(result*(((c+1)/2)%m))%m;	
	}

	return result;
}

int main (void)
{
	int T;
	ulli N, MOD, n, m;
	scanf("%d", &T);

	for (int t=0; t<T; t++)
	{
		scanf("%llu%llu", &N, &MOD);
		ulli result=1;

		for (ulli i=0; i<N; i++)
		{
			scanf("%llu%llu", &n, &m);
			result=(result*(numSubMat(n, m, MOD)))%MOD;
		}

		printf("%llu\n", result);
	}
}