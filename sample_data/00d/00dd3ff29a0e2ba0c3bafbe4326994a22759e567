# COPYRIGHT MCSKRIPTS.DK ALLE RETTIGHEDER FORBEHOLDT #
#         DETTE SKRIPT MÅ IKKE VIDERESÆLGES          #

#--------------------------------------------------------------------------------------#
# 																					   #
#               Skript lavet til McSkript's officielle Minecraft server                #
#                           Lavet af Victortm, Tidsrejsen™                             #
#           Alle rettigheder til salg og destribution forholdes til Victortm™          #
# 																					   #
#       Videregiv ikke dette skript i dit eget navn, men du er velkommen til at        #
#   videreudvikle på skriptet og derefter videregive det, men ikke uden at Victortm    #
#                    bliver nævnt som skriptets første-udvikler!                       #
# 																					   #
#--------------------------------------------------------------------------------------#
#                                                                                      #
#            KONFIGURERING - SKIFT KUN HVIS DU HAR STYR PÅ, HVAD DU LAVER              #
options:
	prefix: &3&lMC&f&lS   #-- Dette er prefixet der benyttes i chatten før hver besked.
	levelmaks: 250        #-- Sæt til "ingen" hvis der ingen level maks skal være.
	xp_per_kill: 5        #-- Hvor meget xp man før per. kill
	gf: �f                #-- Grundfarve der bliver benyttet.
	sf: �b                #-- Specielfarve der bliver benyttet.
	npc_navn: &bLevel     #-- Npc navnet på npc'en med level menuen/gui'en.
	chat: fra            #-- Slå chatten fra/til. ("til" eller "fra")
	#Beskrivelse - {@gf} = grundfarven  {@sf} = speciel farven. || laver rny linje. (Rediger kun hvis du ved, hvad du laver!
	beskrivelse: {@gf}Level-systemet fungerer på||{@gf}den måde, at når du dræber en||{@gf}person, før du {@sf}{@xp_per_kill} xp,||{@gf}som du kan bruge til at level-up.||&8||{@gf}Kæmp for at komme på top-5||{@gf}listen, så du kan bevise overfor||{@gf}dine venner, hvem der er||{@gf}den bedste!
#--------------------------------------------------------------------------------------#
on script load:
	set {_chat} to "{@chat}"
	if {_chat} is not "til":
		loop all players:
			if loop-player has permission "admin":
				wait 2 ticks
				send " " to loop-player
				send "{@prefix} {@gf}Bemærk at chatten er slået &cfra{@gf}!" to loop-player
				send " " to loop-player
				stop

on join:
	if {level::*} doesn't contain "%player%":
		add "%player%" to {levels::*}
	if {level::%player's uuid%} is not set:
		set {level::%player's uuid%} to 1
	if {xp.%player's uuid%} is not set:
		set {xp.%player's uuid%} to 0

on right click on an entity:
	if name of entity is "{@npc_navn}":
		set {_xpneeded} to {level::%player's uuid%} * 10
		open chest with 5 rows named "{@npc_navn}" to player
		wait 2 ticks
		format slot 0 of player with black stained glass named "&8" to be unstealable
		format slot 1 of player with black stained glass named "&8" to be unstealable
		format slot 2 of player with black stained glass named "&8" to be unstealable
		format slot 3 of player with black stained glass named "&8" to be unstealable
		format slot 4 of player with black stained glass named "&8" to be unstealable
		format slot 5 of player with black stained glass named "&8" to be unstealable
		format slot 6 of player with black stained glass named "&8" to be unstealable
		format slot 7 of player with black stained glass named "&8" to be unstealable
		format slot 8 of player with black stained glass named "&8" to be unstealable
		format slot 36 of player with black stained glass named "&8" to be unstealable
		format slot 37 of player with black stained glass named "&8" to be unstealable
		format slot 38 of player with black stained glass named "&8" to be unstealable
		format slot 39 of player with black stained glass named "&8" to be unstealable
		format slot 40 of player with red stained glass named "&cLuk menu" to close
		format slot 44 of player with black stained glass named "&8" to be unstealable
		format slot 41 of player with black stained glass named "&8" to be unstealable
		format slot 42 of player with black stained glass named "&8" to be unstealable
		format slot 43 of player with black stained glass named "&8" to be unstealable
		loop {level::*}:
			add 1 to {_size}
			if {_low.to.high.list::%loop-value%} is not set:
				set {_low.to.high.list::%loop-value%} to loop-index
			else:
				set {_n} to 0
				loop {_size} times:
					set {_n} to {_n}+1
					{_low.to.high.list::%loop-value-1%.%{_n}%} is not set
					set {_low.to.high.list::%loop-value-1%.%{_n}%} to loop-index
					stop loop
		wait 1 tick
		set {_n} to size of {_low.to.high.list::*}
		loop {_low.to.high.list::*}:
			set {_high.to.low.list::%{_n}%} to loop-value
			set {_n} to {_n}-1
		wait 1 tick
		set {_result} to 0
		loop {_high.to.low.list::*}:
			add 1 to {_result}
			set {_navn} to player from uuid "%loop-value%"
			if {_result} is 1:
				set {_nummer1} to "&a1. &8- {@gf}%{_navn}% &8> {@gf}lvl %{level::%loop-value%}%"
			if {_result} is 2:
				set {_nummer2} to "&62. &8- {@gf}%{_navn}% &8> {@gf}lvl %{level::%loop-value%}%"
			if {_result} is 3:
				set {_nummer3} to "&c3. &8- {@gf}%{_navn}% &8> {@gf}lvl %{level::%loop-value%}%"
			if {_result} is 4:
				set {_nummer4} to "{@gf}4. &8- {@gf}%{_navn}% &8> {@gf}lvl %{level::%loop-value%}%"
			if {_result} is 5:
				set {_nummer5} to "{@gf}5. &8- {@gf}%{_navn}% &8> {@gf}lvl %{level::%loop-value%}%"
			if {_result} is more than 5:
				stop
		if {_nummer2} is not set:
			format slot 20 of player with gold helmet named "&3&lLevel &r&8- &3&lTop 5" with lore "&8&m------------------------||%{_nummer1}%||&8&m------------------------" to be unstealable
		else if {_nummer3} is not set:
			format slot 20 of player with gold helmet named "&3&lLevel &r&8- &3&lTop 5" with lore "&8&m------------------------||%{_nummer1}%||%{_nummer2}%||&8&m------------------------" to be unstealable
		else if {_nummer4} is not set:
			format slot 20 of player with gold helmet named "&3&lLevel &r&8- &3&lTop 5" with lore "&8&m------------------------||%{_nummer1}%||%{_nummer2}%||%{_nummer3}%||&8&m------------------------" to be unstealable
		else if {_nummer5} is not set:
			format slot 20 of player with gold helmet named "&3&lLevel &r&8- &3&lTop 5" with lore "&8&m------------------------||%{_nummer1}%||%{_nummer2}%||%{_nummer3}%||%{_nummer4}%||&8&m------------------------" to be unstealable
		else:
			format slot 20 of player with gold helmet named "&3&lLevel &r&8- &3&lTop 5" with lore "&8&m------------------------||%{_nummer1}%||%{_nummer2}%||%{_nummer3}%||%{_nummer4}%||%{_nummer5}%||&8&m------------------------" to be unstealable
		format slot 22 of player with book named "&3&lInformation" with lore "&8&m------------------------||{@beskrivelse}||&8&m------------------------" to be unstealable
		format slot 24 of player with iron sword named "&3&lLevel" with lore "&8&m------------------------||{@sf}Level: {@gf}lvl %{level::%player's uuid%}%||{@sf}XP: {@gf}%{xp.%player's uuid%}%&8/{@gf}%{_xpneeded}% xp||&7||{@gf}&oDit level stiger automatisk,||{@gf}&ohvis du har nok xp.||&8&m------------------------" to be unstealable
		stop

on death:
	if attacker is a player:
		add {@xp_per_kill} to {xp.%attacker's uuid%}
		set {_levelmaks} to "{@levelmaks}"
		if {_levelmaks} is not "ingen":
			if {level::%attacker's uuid%} is not {@levelmaks}:
				set {_xpneeded} to {level::%attacker's uuid%} * 10
				if {xp.%attacker's uuid%} is more than or equal to {_xpneeded}:
					set {xp.%attacker's uuid%} to 0
					add 1 to {level::%attacker's uuid%}
					send " " to attacker
					send "{@prefix} {@gf}Dit level steg! Du er nu {@sf}lvl %{level::%attacker's uuid%}%{@gf}!" to attacker
					send " " to attacker
	stop
	
on chat:
	set {_chat} to "{@chat}"
	if {_chat} is "til":
		cancel event
		set {_prefix} to "%coloured player's prefix%"
		set {_suffix} to "%coloured player's suffix%"
		broadcast "&8[{@sf}%{level::%player's uuid%}%&8]%{_prefix}%%{_suffix}% %player%&8: {@gf}%message%"
		stop