#include <signal.h>
#include <stdlib.h>
#include <sys/types.h>
#include <stdio.h>
#include <unistd.h>


void handler(int);
void sig_handler(int);

int main()
{
  int PID, i;
  PID = fork();

  if(PID>0) //padre
  {
    signal(SIGCHLD, handler);
    for(i=0;i<10000000;i++)         //attivitÃ  del padre
    {
      sleep(1);
      printf("Io sono il padre del vez\n");
      if(signal(SIGINT,sig_handler) == SIG_ERR)
      {
        printf("\nNon trovo SIGINT\n");
      }
    }
      

  }
  else
  {
    for(i=0;i<1000;i++)
    {
      sleep(1);
      printf("Sono il vez\n");
      printf("pid figlio:%d\n",getpid());
      if(signal(SIGINT,sig_handler) == SIG_ERR)
      {
        printf("\nNon trovo SIGINT\n");
      }
    }
    exit(1);
  }
exit(0);

}

void sig_handler(int signo)
{
   if(signo == SIGINT)
   {
      printf("\n\nBellaaaaa vez\n\n");
   }
}

void handler(int signum)
{
  int status;
  wait(&status);
  printf("Stato figlio %d\n",status>>8);
}