from sklearn.linear_model import LogisticRegression

# Set up model.
logistic_model = LogisticRegression(random_state=1, multi_class='multinomial', solver='saga')

# Training.
logistic_model.fit(x_train, y_train)

########### Tesing Report Code Chunk ###########

from sklearn.metrics import confusion_matrix, classification_report, f1_score, accuracy_score

# Score on testing dataset.
feature = x_test
pred = logistic_model.predict(feature) # direct output its predicted label
y_test = np.array(y_test)

printmd('**Scoring on Testing Dataset:**\n')
print('Confusion Matrix:\n', confusion_matrix(y_test, pred))
print('\nClassification Report:\n', classification_report(y_test, pred))
print('\naccuracy: {:.3f}'.format(accuracy_score(y_test, pred)))
print('f1 score: {:.3f}'.format(f1_score(y_test, pred, average='weighted')))