# coding: utf-8
from django.http import Http404, HttpResponseRedirect
from django.core.context_processors import csrf
from statistic.forms import hostingAdd
from django.shortcuts import render_to_response
from abuse_service.statistic.models import hosting_list, hosting_id

def index(request):
        form = hostingAdd()
        lists_all = hosting_list.objects.all().order_by('-id')[:40]      # login                                                                                                  - id_login
        return render_to_response('index.html', {'lists': lists_all, 'form': for                                                                                                 m})


def id_hosting(request, login_id):
        # БШАХПЮЕЛ ЙНМЙПЕРМШИ ОНЯР, pk - primary key
        #try:
                user = hosting_list.objects.get(pk=int(login_id))
                field = hosting_id.objects.filter(id_login=user)
   # except:            return "Error DatinG"
                return render_to_response('id_hosting.html', {'detail': user, 'f                                                                                                 ield': field})


def user_add(request):
        if request.method == "POST":
                form = hostingAdd(request.POST)
                if form.is_valid():
                        data=form.cleaned_data
                        data1 = hosting_list(login=data["login"], server=data['s                                                                                                 erver'], ticket=data['ticket'], reason=data['reason'])
                        data1.save()
                        return HttpResponseRedirect('/')
        else: