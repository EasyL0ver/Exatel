script.Parent = game.ServerScriptService
_G.mytable = {}
repeat wait() until game.Workspace and game.Players
local r = 200
local g = 180
local b = 40
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local DeleteFunction = Instance.new("RemoteEvent", ReplicatedStorage)
DeleteFunction.Name = "DeleteFunction"
_G.shieldpower = 2000
local debounce = 	false
_G.i = 1
local e = 1
local greencheck = false
local powertable = {}
powertable[e] = 2000
Players = game:GetService("Players")
local player = Players:WaitForChild("ethanguy24")
local character = player.CharacterAdded:wait()
local humanoid = character.Humanoid
local shieldactivate = true
repeat wait() until character
local ff = Instance.new("ForceField",character)
ff.Visible = false
function location()
locations = character.UpperTorso.Position
end
function circle()
character.UpperTorso.Anchored = true
location()
collide = Instance.new("Part", workspace)
collide.Position = locations
collide.Shape = 0
collide.Size = Vector3.new(8,8,8)
collide.CanCollide = false
collide.Transparency = .4
collide.Locked = true
collide.Anchored = false
collide.Color = Color3.new(100,0,0)
collide.Material = "Neon"
collide.Name = "ShieldDetect"
local field = Instance.new("ForceField",collide)
field.Visible = false
local welding = Instance.new("Weld", collide)
welding.Part0 = collide
welding.Part1 = character["LowerTorso"]
character.UpperTorso.Anchored = false
end


circle()
function OntouchDestroy(hit)
e = e+1 
powertable[e] = _G.shieldpower
if powertable[e] < powertable[e-1] then
--if greencheck == false and _G.shieldpower <=1500 and collide.Color ~= Color3.new(40,127,71) then
--repeat
--collide.Color = collide.Color - Color3.new(1,1,-1)
--until collide.Color == Color3.new(40,127,71)
--elseif _G.shieldpower > 1500 then
--repeat
--collide.Color = collide.Color + Color3.new(1,1,1)
--until collide.Color == Color3.new(13,105,172)
--end
if hit == workspace:FindFirstChild("Baseplate") or workspace:FindFirstChild(character) or nil or hit == workspace:FindFirstChild("DeleteEffect") or hit == workspace:FindFirstChild("Pulse") then

elseif hit.Parent:FindFirstChild("Humanoid") then
	
else		
if hit ~= nil and _G.shieldpower > 0 then
	
hit.Velocity = Vector3.new(0,0,0)
hit.Anchored = true
local deflect = Instance.new("Part", workspace)
deflect.CanCollide = true
deflect.Anchored = true
deflect.Name = "DeleteEffect"
local mesh = Instance.new("SpecialMesh",deflect)
mesh.MeshType = Enum.MeshType.FileMesh
mesh.MeshId = "rbxassetid://945057640"
mesh.TextureId = "http://www.roblox.com/asset/?id=1587388333"
mesh.Scale = hit.Size + Vector3.new(.5,.5,.5)
deflect.Position = hit.Position
hit:Destroy()
print("strange")
wait(4)
print("been 4 seconds?")
hit = nil
deflect:Destroy()
end
end
wait(.01)
end
end
collide.Touched:Connect(OntouchDestroy)

function HealthChange()
repeat wait() until _G.mytable[_G.i] ~= nil
print("this is my table below")
print(_G.mytable[_G.i])
print("Up above")
damage = math.abs(100 - _G.mytable[_G.i])
if damage > 300 then
damage = 300
end
if _G.shieldpower > 0 then
_G.shieldpower = _G.shieldpower - damage
end
print(_G.shieldpower)
print("this is damage below")
print(damage)
end

function HealthChanged1()
if _G.shieldpower > 0 then
local healths = character.Humanoid.Health
_G.mytable[_G.i] = healths
print("This is healths below")
 print(healths)
HealthChange()
local damages = math.abs(100 - healths)
character.Humanoid.Health = healths + damages
_G.i = _G.i+1
 -- print(shieldpower)
-- print(damage)
else
	
end
end
humanoid.HealthChanged:Connect(HealthChanged1)
local r = false
function LowHealthPulse()
while 1==1 do
wait(.5)
if _G.shieldpower <= 500 then
repeat
if not workspace:FindFirstChild("Pulse") then
brick = Instance.new("Part", workspace)
brick.Shape = 0
brick.Name = "Pulse"
brick.Position = collide.Position
brick.Color = collide.Color
brick.Size = collide.Size
brick.Material = collide.Material
brick.Transparency = collide.Transparency
brick.CanCollide = false
brick.Anchored = true
brick.Locked = true
end
wait(.005)
if r == false then
repeat
r = true
local x = collide.Position.X
local y = brick.Position.Y
local z = brick.Position.Z
brick.Position = Vector3.new(x,y,z)
brick.Size = brick.Size + Vector3.new(.15,.15,.15)
brick.Transparency = brick.Transparency + .05
wait(.005)
until brick.Transparency >= 1
brick:Destroy()
print("Destroyed!")
r = false
end
until _G.shieldpower > 500
end
end
end
spawn(LowHealthPulse)

local gui = Instance.new("ScreenGui")
gui.Parent = player.PlayerGui

local frame = Instance.new("Frame")
frame.Parent = gui
frame.Position = UDim2.new(0,0,0,0)
frame.Size = UDim2.new(.2,.2,.2,.2)
function connection()
run:disconnect() 
end
humanoid.Died:Connect(connection)
run = game:GetService('RunService').Stepped:Connect(function()

if character.UpperTorso.Position.Y <= -23 then
character.UpperTorso.Parent:MoveTo(Vector3.new(17,10.5,14))
character.UpperTorso.Anchored = true
character.UpperTorso.Velocity = Vector3.new(0,0,0)
character.UpperTorso.Anchored = false
end
if not collide:FindFirstChildOfClass("ForceField") then
local force = Instance.new("ForceField",collide)
force.Visible = false
end
if _G.shieldpower < 0 then
_G.shieldpower = 0
elseif _G.shieldpower > 2000 then
_G.shieldpower = 2000
end
if workspace:FindFirstChild("ShieldDetect") then
	
else
circle()
function OntouchDestroy(hit)
e = e+1 
powertable[e] = _G.shieldpower
if powertable[e] < powertable[e-1] then
if hit == workspace:FindFirstChild("Baseplate") or workspace:FindFirstChild(character) or nil or hit == workspace:FindFirstChild("DeleteEffect") or hit == workspace:FindFirstChild("Pulse") then

elseif hit.Parent:FindFirstChild("Humanoid") then
	
else		
if hit ~= nil and _G.shieldpower > 0 then
	
hit.Velocity = Vector3.new(0,0,0)
hit.Anchored = true
local deflect = Instance.new("Part", workspace)
deflect.CanCollide = true
deflect.Anchored = true
deflect.Name = "DeleteEffect"
local mesh = Instance.new("SpecialMesh",deflect)
mesh.MeshType = Enum.MeshType.FileMesh
mesh.MeshId = "rbxassetid://945057640"
mesh.TextureId = "http://www.roblox.com/asset/?id=1587388333"
mesh.Scale = hit.Size + Vector3.new(.5,.5,.5)
deflect.Position = hit.Position
hit:Destroy()
print("strange")
wait(4)
print("been 4 seconds?")
hit = nil
deflect:Destroy()
end
end
wait(.01)
end
end
collide.Touched:Connect(OntouchDestroy)
end
end)