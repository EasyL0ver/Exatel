local seat = false
local kaleka = true
local n = 1
 
Citizen.CreateThread(function()
    while kaleka do
        Wait(0)
 
        local model = "prop_wheelchair_01_s"
    local dict = "fin_c_int-3"
        while not HasAnimDictLoaded(dict) and not HasModelLoaded(model) do
            Wait(10)
            RequestModel(model)
            RequestAnimDict(dict)
      print("OK")
        end
 
        local ped = GetPlayerPed(-1)
    local x,y,z = table.unpack(GetEntityCoords(ped))
        local closeseat = GetClosestObjectOfType(GetEntityCoords(ped), 3.0, GetHashKey(model), true)
        local sx,sy,sz = table.unpack(GetEntityCoords(closeseat))
        local heading = GetEntityHeading(closeseat)
        local pitch, roll, yaw = table.unpack(GetEntityRotation(closeseat, 2))
        local fx,fy,fz = table.unpack(GetOffsetFromEntityInWorldCoords(closeseat, 0.0, 1.0, 0.0))
    local fx2,fy2,fz2 = table.unpack(GetOffsetFromEntityInWorldCoords(closeseat, 0.0, -1.0, 1.0))
 
 
DrawLine(x, y, z, sx,sy,sz, 255, 0, 255, 255)
 
    if closeseat ~= 0 then
      if IsControlJustPressed(0, 20) and seat == false then
        AttachEntityToEntity(ped, closeseat, 0, 0.0,0.0,0.6, 0.0, 0.0, 180.0, 0, false, true, true, false, true)
        if IsEntityAttached(ped) then
          TaskPlayAnim(ped, dict, "cs_lestercrest_dual-3", 10.0, 10.0, -1, 0+1, 0, 0.0, -0.0, 0.0)
          seat = true
        end
      end
    end
 
    if IsControlJustPressed(0, 21) then
      CreateObject(GetHashKey(model), x,y,z, true, false, false)
      SetEntityInvincible(closeseat, true)
      PlaceObjectOnGroundProperly(closeseat)
    end
 
        if seat == true then
            if IsControlPressed(0, 34) then -- a
                SetEntityHeading(closeseat, heading+1.0)
            end
            if IsControlPressed(0, 35) then -- d
                SetEntityHeading(closeseat, heading-1.0)
            end
            if IsControlJustPressed(0, 32) then -- w
        SetObjectPhysicsParams(closeseat, 100.0, 1.0, 1.0, 1.0, 1.0, 100.0, 0.0, 0.0, 0.0, 0.0, 0.0)
        ApplyForceToEntity(closeseat, 1, fx,fy,fz, 0.0, 0.0, 0.0, 0, true, 0, false)
      end
 
            if IsControlJustPressed(0, 38) then --stand up
        SetEntityCollision(ped, true, true)
                DetachEntity(closeseat, true, true)
        DetachEntity(ped, true, true)
        StopAnimTask(ped, dict, "base", 3)
                seat = false
            end
 
            if pitch >= 60 or pitch <= -60 or roll >= 60 or roll <= -60 or IsPedRagdoll(ped) then -- drop
        SetEntityCollision(ped, true, true)
                DetachEntity(ped, true, true)
                StopAnimTask(ped, dict, "base", 3)
        SetPedToRagdoll(ped, 10, 100, 0)
                seat = false
            end
    end
    if pitch >= 60 or pitch <= -60 or roll >= 60 or roll <= -60 then
      if IsControlJustPressed(0, 38) then
        SetEntityRotation(closeseat, 0.0, 0.0, yaw, 2, true)
        PlaceObjectOnGroundProperly(closeseat)
      end
        end
    end
end)