// Created on Y1 D1 1:24:15
clearscreen.
print "Hippity Script Loading".
print " ".
// Variables
print "Version 0.1 variables initzialising".

set curship to ship.

print "Variables loaded".
wait 1.
print "Countdown starts in 3 seconds".
wait 3.
print "T-5 seconds".
wait 1.
print "T-4 seconds, checking variables".
// Check and reset vars
wait 1.
print "T-3 seconds, SAS enabling".
SAS on.
wait 1.
print "T-2 seconds".
wait 1.
print "T-1 second, engine ignition".
stage.
wait 1.
print "Liftoff, monitoring craft".
print " ".
print "Vertical speed: CALCULATING".
print "Altitude: CALCULATING".
wait 2.
until curship:verticalspeed < 1 {
  clearscreen.
  print "Liftoff, monitoring craft".
  print " ".
  print "Vertical speed: " + floor(curship:verticalspeed) + " m/s".
  print "Altitude: " + floor(alt:radar) + " m".
  wait 0.01.
}

// Ship is descending

clearscreen.
print "Ship is descending, initiating descent protocols".
wait 1.
print "Decoupling capsule from SRB".
wait 1.
stage.
print " ".
print "Capsule detached, monitoring ship until safe to deploy chutes".
print "Locking to retrograde".
lock steering to ship:retrograde.
print " ".
print "Vertical speed: CALCULATING".
print "Altitude: CALCULATING".
wait 2.
until curship:verticalspeed > -400 and alt:radar < 8000 {
  clearscreen.
  
  print "Capsule detached, monitoring ship until safe to deploy chutes".
  print " ".
  print "Vertical speed: " + floor(curship:verticalspeed) + " m/s".
  print "Altitude: " + floor(alt:radar) + " m".
  wait 0.01.
}

// Drogue chutes ready
clearscreen.
print "Ship able to deploy drogue chutes".
wait 1.
stage.
print "Drogue chutes deployed".
print " ".
print "Monitoring until safe to deploy main chutes".
print " ".
print "Vertical speed: CALCULATING".
print "Altitude: CALCULATING".
wait 2.
until curship:verticalspeed > -250 and alt:radar < 5000 {
  clearscreen.

  print "Monitoring until safe to deploy main chutes".
  print " ".
  print "Vertical speed: " + floor(curship:verticalspeed) + " m/s".
  print "Altitude: " + floor(alt:radar) + " m".
  wait 0.01.
}

// Main chutes ready
clearscreen.
print "Ship able to deploy main chutes".
wait 1.
stage.
print "Main chutes deployed".
print " ".
wait 2.
print "Hippity Routine finished, shutting down core in 3 seconds".
wait 3.
print "Core shutdown, all control and SAS returned to you".
shutdown.